{
    "teacher_model_id":  "google/gemma-3-270m-it",
    "datasets": [
        {
            "kind": "text",
            "path": "private/data/c4_clean.txt",
            "ratio": 0.10
        },
        {
            "kind": "nemotron_chat",
            "dataset_name": "nvidia/Nemotron-Instruction-Following-Chat-v1",
            "split": "chat_if",
            "ratio": 0.90,
            "assistant_only_loss": true
        }
    ],
    "seq_len":  512,
    "micro_batch_size":  4,
    "grad_accum":  8,
    "steps":  1000,
    "lr":  0.0002,
    "weight_decay":  0.01,
    "warmup_steps":  100,
    "max_grad_norm":  1.0,
    "temperature":  2.0,
    "kl_weight":  1.0,
    "ce_weight":  0.1,
    "alpha_max":  0.4,
    "alpha_warmup_steps":  200,
    "teacher_scale_start":  1.0,
    "teacher_scale_end":  0.2,
    "wda_scale_start":  1.0,
    "wda_scale_end":  1.0,
    "handoff_start_step":  400,
    "handoff_steps":  400,
    "alpha_layer_scale":  "sqrt",
    "init_gamma":  0.1,
    "gamma_l1_weight":  0.0005,
    "gamma_l1_target":  0.2,
    "wda_num_masks":  32,
    "wda_num_waves_per_mask":  4,
    "wda_topk_masks":  8,
    "wda_attn_alpha":  3.0,
    "wda_content_mix":  0.1,
    "wda_learned_content":  true,
    "wda_use_sin_waves":  false,
    "wda_use_sampling":  false,
    "wda_num_samples":  32,
    "wda_noise_sigma":  0.12,
    "wda_step_alpha":  6.0,
    "wda_use_checkpoint":  true,
    "device":  "cuda",
    "torch_dtype":  "bfloat16",
    "gradient_checkpointing":  false,
    "log_every":  1,
    "save_every":  100,
    "out_dir":  "private/checkpoints/transplant_gemma270m_3090_1k"
}
{
    "teacher_model_id": "Qwen/Qwen2.5-1.5B-Instruct",
    "datasets": [
        {
            "kind": "local_jsonl",
            "path": "private/data/tech_cache/chat_if.jsonl",
            "is_chat": true,
            "assistant_only_loss": true,
            "ratio": 0.50
        },
        {
            "kind": "local_jsonl",
            "path": "private/data/tech_cache/Nemotron-Pretraining-InfiniByte-Reasoning.jsonl",
            "ratio": 0.15
        },
        {
            "kind": "local_jsonl",
            "path": "private/data/tech_cache/Nemotron-Pretraining-Scientific-Coding.jsonl",
            "ratio": 0.15
        },
        {
            "kind": "local_jsonl",
            "path": "private/data/tech_cache/Nemotron-Pretraining-Math-Textbooks.jsonl",
            "ratio": 0.10
        },
        {
            "kind": "local_jsonl",
            "path": "private/data/tech_cache/Nemotron-Pretraining-Wiki-Rewrite.jsonl",
            "ratio": 0.05
        },
        {
            "kind": "local_jsonl",
            "path": "private/data/tech_cache/Nemotron-Pretraining-STEM-SFT.jsonl",
            "ratio": 0.05
        }
    ],
    "seq_len": 1024,
    "micro_batch_size": 1,
    "grad_accum": 16,
    "steps": 4000,
    "lr": 0.0002,
    "weight_decay": 0.02,
    "warmup_steps": 100,
    "max_grad_norm": 1.0,
    "temperature": 1.5,
    "kl_weight": 1.2,
    "ce_weight": 0.5,
    "alpha_max": 0.9,
    "alpha_warmup_steps": 250,
    "teacher_scale_start": 1.0,
    "teacher_scale_end": 0.5,
    "wda_scale_start": 1.0,
    "wda_scale_end": 1.3,
    "handoff_start_step": 350,
    "handoff_steps": 800,
    "alpha_layer_scale": "sqrt",
    "out_dir": "private/checkpoints/transplant_qwen1.5b_hero",
    "device": "cuda",
    "torch_dtype": "bfloat16",
    "quantization": "4bit",
    "gradient_checkpointing": true,
    "save_every": 100,
    "log_every": 1,
    "wda_num_masks": 128,
    "wda_num_waves_per_mask": 4,
    "wda_topk_masks": 16,
    "wda_attn_alpha": 4.0,
    "wda_content_mix": 0.15,
    "wda_learned_content": true,
    "wda_use_sin_waves": false,
    "wda_use_sampling": false,
    "wda_num_samples": 32,
    "wda_noise_sigma": 0.08,
    "wda_step_alpha": 8.0,
    "wda_use_checkpoint": true,
    "init_gamma": 0.05,
    "gamma_l1_weight": 0.0001,
    "gamma_l1_target": 0.15
}
